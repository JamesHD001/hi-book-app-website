<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Your messages on Hi!Book" />
    <title>Hi!Book - Messages</title>

    <link rel="stylesheet" href="./styles/hibook.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Winky+Rough:wght@300;400;600&display=swap" rel="stylesheet"/>
  </head>

  <body>
    <!-- HEADER -->
    <header>
      <nav>
        <div class="main-navbar">
          <div class="gradient-logo" id="gradient-logo">
            <a href="index.html">Hi!Book</a>
          </div>
          <ul class="main-nav-links" id="navLinks">
            <li><a href="home.html" title="Home"><i data-lucide="home"></i></a></li>
            <li><a href="messages.html" title="Messages"><i data-lucide="message-circle"></i></a></li>
            <li><a href="friends.html" title="Friends"><i data-lucide="users"></i></a></li>
            <li><a href="notifications.html" title="Notifications"><i data-lucide="bell"></i></a></li>
            <li><a href="profile.html" title="Profile"><i data-lucide="user"></i></a></li>
            <li><a href="settings.html" title="Settings"><i data-lucide="settings"></i></a></li>
          </ul>
          <div class="hamburger" id="hamburger">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </div>
      </nav>
    </header>

    <!-- MESSAGES SECTION -->
    <div class="messages-container">
      <!-- Sidebar -->
      <div class="conversations-sidebar" id="conversationsSidebar">
        <!-- Empty state message -->
        <div class="empty-state" id="emptyState">
          ðŸ’¬ No conversations yet.<br>Start a chat with a friend!
        </div>
      </div>

      <!-- Chat Area -->
      <div class="chat-area">
        <div class="chat-header" id="chatHeader">Select a conversation</div>
        <div class="chat-messages" id="chatMessages"></div>

        <!-- Input Bar -->
        <div class="chat-input">
          <textarea id="chatMessage" rows="1" placeholder="Type a message..." disabled></textarea>
          <button id="sendMessage" disabled>Send</button>
        </div>
      </div>
    </div>

    <!-- Floating Button -->
    <button class="new-chat-btn" id="newChatBtn" title="Start New Chat">
      <i data-lucide="plus"></i>
    </button>

    <!-- SCRIPTS -->
    <script type="module" src="./auth/auth.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="./script.js"></script>
    <script>
      const sidebar = document.getElementById("conversationsSidebar");
      const emptyState = document.getElementById("emptyState");
      const newChatBtn = document.getElementById("newChatBtn");

      // Example: Load conversations dynamically (for now just simulate one)
      const conversations = []; // Empty means no chats yet

      function loadConversations() {
        if (conversations.length === 0) {
          emptyState.style.display = "flex";
        } else {
          emptyState.style.display = "none";
          conversations.forEach(conv => {
            const div = document.createElement("div");
            div.classList.add("conversation");
            div.innerHTML = `
              <img src="${conv.avatar}" alt="User">
              <div>
                <strong>${conv.name}</strong>
                <p style="font-size: 0.85rem; color: #666;">${conv.lastMessage}</p>
              </div>
            `;
            sidebar.appendChild(div);
          });
        }
      }

      loadConversations();

      // Handle new chat button click
      newChatBtn.addEventListener("click", () => {
        alert("Start a new chat! (Later, this will open a friend search modal)");
      });
    </script>
  </body>
</html>
